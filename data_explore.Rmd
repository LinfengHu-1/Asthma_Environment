---
title: "data_exploration"
author: "Pluto Zhang"
date: "2022-10-07"
output: pdf_document
---

```{r}
library(rstudioapi)
library(tidyverse)
library(gam)
library(splines)
library(splines2)  
library(dplyr)
library(tidyr)
library(broom)
library(dslabs)
library(ggplot2)
library(ggthemes)
library(ggrepel)
# data cleaning for socio economic factors
soecon <- read_csv('soecon.csv')
dat_full <- read.csv("fulldata.csv")

```


```{r}
names(soecon)
```



Run a summary of the variables in socioeconomic category
```{r}
summary(soecon)
```



Draw histograms of the variables in the dataset
```{r}
par(mfrow = c(2,2))
hist(soecon$SNAP, main='SNAP enrollment across states', xlab = 'per 10,000 people' )
hist(log(soecon$SNAP))

hist(soecon$individual_homeless, main = 'Homeless individuals across states', xlab = 'per 10,000 people')
hist(log(soecon$individual_homeless))

hist(soecon$fam_homeless, main = 'Homeless in families across states', xlab = 'per 10,000 people')
hist(log(soecon$fam_homeless))

hist(soecon$total_homeless, main = 'Total homeless across states ', xlab = 'per 10,000 people')
hist(log(soecon$total_homeless))

hist(soecon$unemployment_rate, main='Unemployment rate across states', xlab = 'unemployment rate')


hist(soecon$Total_poverty, main='Total poverty across states', xlab = 'percentage of total population')

```

based on the histograms, most of the variables have skewed distribution, but after taking the logarithms of them, they tend to have more normal distribution. This is because most of the variables are population data, and the population values are big, but after taking the logarithms, the values will be more normally distributed.



```{r}
pairs(soecon$total_homeless ~ soecon$SNAP + soecon$unemployment_rate + soecon$Total_poverty )
```
Based on the paired scatter plot, there is no obvious colinearity between the four main socioeconomic variables: SNAP enrollment, total_poverty rate, unemployment rate and total number of homeless people, which means that these four variables are independent with each other. 


```{r}
# for the homeless variable, test for colinearity between its three subvariables 
pairs(soecon$total_homeless ~ soecon$individual_homeless + soecon$fam_homeless)
```
from the paired scatter plot, we can see that the total number of homeless people is correlated with number os homeless individuals and the number of homeless people in families, so these three variables are not independent with each other.
```{r}
# for the homeless variable, test for colinearity between its three subvariables 
pairs(soecon$Total_poverty ~ soecon$Male_poverty + soecon$Female_poverty)
```
By plotting the percentage of males and females that are in poverty in each state against each other, we can see that these variables are linearly correlated with each other and are not independent. 

```{r}
fulldat <- read_csv('FullData.csv')
names(fulldat)[names(fulldat) == 'DataValue'] <- 'Asthmap'
names(fulldat)[names(fulldat) == 'TOBDataValue'] <- 'TOB'


# now we try to determine which variable is more significant in predicting the Asthma prevalence
# forward selection
coln <- colnames(fulldat)

coln
fulldat <- fulldat |> drop_na()

require(broom)
#forward selection procedure using AIC values 
lm1 <- lm(Asthmap ~ 1, data=fulldat)
stepModel <- step(lm1, direction="forward",
scope=(~ selfHlthDataValue + HlthCareDataValue + SNAP+ individual_homeless+fam_homeless+total_homeless+unemployment_rate+Male_poverty+Female_poverty+Total_poverty+o3_mean+pm2.5_mean+so2_mean+co_mean+no2_mean), data=fulldat)

```

<<<<<<< HEAD

#### CDI data
```{r}
names(dat_full[, 1:25])
```
```{r}
dat_full <- read.csv("FullData.csv")
summary(dat_full[, 4:25])
```
```{r}
hist(dat_full$DataValue, main='Histogram of asthma crude prevalence among women aged 18-44 years across states' )
hist(dat_full$TOBDataValue, main='Histogram of Percent current cigarette smoking among women aged 18-44 years across states')
hist(dat_full$selfHlthDataValue, main = 'Histogram of Self-rated health status among women aged 18-44 years across states')
```





=======
```{r}
par(mfrow=c(3,6))
hist(dat_full$DataValue.x)
hist(dat_full$TOBDataValue)
hist(dat_full$HlthCareDataValue)
hist(dat_full$DataValue.x.x)
```


```{r}
#air pollutant exploratory

par(mfrow = c(3,2))
plot(dat_full$DataValue ~ dat_full$o3_mean, ylab = "Asthma Pervalence", xlab = "Ozone")
plot(dat_full$DataValue ~ dat_full$pm2.5_mean,ylab = "Asthma Pervalence", xlab = "PM2.5")
plot(dat_full$DataValue ~ dat_full$so2_mean,ylab = "Asthma Pervalence", xlab = "Sulfur Dioxide")
plot(dat_full$DataValue ~ dat_full$co_mean, ylab = "Asthma Pervalence", xlab = "Carbon Monoxide")
plot(dat_full$DataValue ~ dat_full$no2_mean, ylab = "Asthma Pervalence", xlab = "Nitrogen Dioxide")

pairs(o3_mean ~ pm2.5_mean + so2_mean + co_mean + no2_mean, data = dat_full)
```
>>>>>>> 6e98b540ba43e672cb60c0ef0d4f92ae0bfda457


```{r}
# analysis of Asthma Pervalence and socioeconomic variables 
pairs(Asthmap ~ total_homeless + SNAP + unemployment_rate + Total_poverty, dat = fulldat)

```
from the paired scatterplot, 
